---
const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1); // remove the first "/"
---

<div x-data="{ 
  isOpen: false,
  isScrolled: false
}">
  <!-- Menu Container -->
  <div x-cloak x-show="isOpen" class="fixed inset-0 z-[150]">
    <!-- Backdrop -->
    <div
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
      class="absolute inset-0 bg-black/60"
      @click="isOpen = false"
    >
    </div>

    <!-- Slide-in Menu -->
    <div
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 translate-x-full"
      x-transition:enter-end="opacity-100 translate-x-0"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100 translate-x-0"
      x-transition:leave-end="opacity-0 translate-x-full"
      class="absolute right-0 inset-y-0 w-full md:w-96 bg-[var(--color-Lightblue)]"
    >
      <nav class="flex flex-col items-end pt-24 md:pt-32 px-8 md:px-16 h-full space-y-6 md:space-y-10">
        <a href="/" class="text-[var(--color-Orange)] text-xl md:text-2xl font-display relative group" :class="{ 'text-[var(--color-Orange)]': currentPath === '' }" @click="isOpen = false">
          <span class="relative z-10">Forside</span>
          <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-[var(--color-Orange)] transition-all duration-300 group-hover:w-full"></span>
        </a>
        <a href="/rejsekalender" class="text-[var(--color-Orange)] text-xl md:text-2xl font-display relative group" :class="{ 'text-[var(--color-Orange)]': currentPath === 'rejsekalender' }" @click="isOpen = false">
          <span class="relative z-10">Rejsekalender</span>
          <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-[var(--color-Orange)] transition-all duration-300 group-hover:w-full"></span>
        </a>
        <a href="/Singleview" class="text-[var(--color-Orange)] text-xl md:text-2xl font-display relative group" :class="{ 'text-[var(--color-Orange)]': currentPath === 'singleview' }" @click="isOpen = false">
          <span class="relative z-10">Singleview</span>
          <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-[var(--color-Orange)] transition-all duration-300 group-hover:w-full"></span>
        </a>
      </nav>
    </div>
  </div>

  <header
    @scroll.window="isScrolled = window.pageYOffset > 60"
    class="fixed top-0 w-full z-[200] transition-all duration-500"
    :class="{'bg-gradient-to-b from-[var(--color-Darkblue)]/80 via-[var(--color-Darkblue)]/60 to-[var(--color-Darkblue)]/0 backdrop-blur-sm': isScrolled}"
  >
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <!-- Logo -->
        <a href="/" class="flex items-center">
          <img x-show="!isScrolled" src="/img/logo/logoorange.webp" alt="Logo" class="md:h-10 h-6 transition-opacity duration-300" />
          <img x-show="isScrolled" src="/img/logo/logowhite.webp" alt="Logo" class="md:h-10 h-6 transition-opacity duration-300" />
        </a>

        <!-- Burger Menu Button -->
        <button @click="isOpen = !isOpen" class="relative z-[201] flex flex-col items-end justify-center group pr-1 md:pr-0" aria-label="Toggle Menu">
          <div class="relative w-8 md:w-11 h-6 md:h-7">
            <span class="absolute w-full h-0.5 bg-[var(--color-Orange)] transition-transform duration-300 ease-in-out origin-center right-1" :class="{'rotate-45 translate-y-[8px]': isOpen, 'translate-y-1': !isOpen}"></span>
            <span class="absolute w-full h-0.5 bg-[var(--color-Orange)] transition-all duration-300 ease-in-out origin-center right-1" :class="{'!-rotate-45 translate-y-[8px]': isOpen, 'translate-y-3': !isOpen}"></span>
            <span class="absolute text-[var(--color-Orange)] text-[10px] md:text-xs tracking-widest font-display transition-all duration-300 whitespace-nowrap -left-1 text-center" :class="{'opacity-0': isOpen, 'translate-y-5': !isOpen}">MENU</span>
          </div>
        </button>
      </div>
    </div>
  </header>
</div>

<style>
  /* Ensure content below header doesn't hide behind it */
  :global(body) {
    padding-top: 5rem;
  }

  [x-cloak] {
    display: none !important;
  }
</style>
